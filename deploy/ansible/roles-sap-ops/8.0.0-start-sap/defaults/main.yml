---
# Capture the role of the hosts

scs_virtual_hostname:                  "{{ sap_sid | lower }}scs{{ scs_instance_number }}cl1"
ers_virtual_hostname:                  "{{ sap_sid | lower }}ers{{ ers_instance_number }}cl2"
db_primary_hostname:
db_secondary_hostname:

- name:                                "Oracle Data Guard: Setting the primary and Secondary DB names"
  ansible.builtin.set_fact:
    db_primary:                       "{{ sap_sid | upper }}_DB[0] }}"         # Oracle Primary Host
    db_secondary:                     "{{ sap_sid | upper }}_DB[1] }}"         # Oracle Secondary Host
  

# Start the SAP Systems
- block:
  - tasks:
     # Start Database
     - name:                           "Start Database"
       ansible.builtin.include_tasks:  "database.yml"
       when: node_tier in ["hana","oracle","oracle-asm","db2"]
   
     # Start Central Services
     - name:                           "Start Central Services"
       ansible.builtin.include_tasks:  "cs-pas-app.yml"
       when:
       - node_tier in ["scs", "ers"]
  when:
    - sap_ops == "start"

- block:
    - tasks:
       # Start Database
       - name:                           "Start Database"
         ansible.builtin.include_tasks:  "database.yml"
         when: node_tier in ["hana","oracle","oracle-asm","db2"]
     
       # Start Central Services
       - name:                           "Start Central Services"
         ansible.builtin.include_tasks:  "cs-pas-app.yml"
         when:
         - node_tier in ["scs", "ers"]
  when:
     - sap_ops == "stop"








  

# # Start Central Services
# - name:                           "Start Central Services"
#   ansible.builtin.include_tasks:  "central_services.yml"
#   when:
#   - node_tier in ["scs", "ers"] 



# # Start Primary Application Server
# - name:                           "Start Primary Application server"
#   ansible.builtin.include_tasks:  "appserver.yml"
#   when:
#   - node_tier == "pas"

# # Start  Application Servers
# - name:                           "Start Primary Application server"
#   ansible.builtin.include_tasks:  "appserver.yml"
#   when:
#   - node_tier == "app"